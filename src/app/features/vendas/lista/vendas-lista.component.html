<div class="kt-container-fluid pt-5">
    <!-- Header/Breadcrumb Estilizado -->
    <div class="flex flex-col gap-2 mb-8">
        <h1 class="text-3xl font-bold text-gray-900 dark:text-white">Pendências</h1>
        <div class="flex items-center gap-2 text-sm text-gray-500">
            <span>Início</span>
            <i class="pi pi-chevron-right text-[10px]"></i>
            <span class="text-primary font-medium">Pendências</span>
        </div>
    </div>

    <!-- Cards de Estatísticas -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-10">
        <!-- Card Vendas Pendentes -->
        <div
            class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700 flex justify-between items-center">
            <div class="flex flex-col gap-1">
                <span class="text-gray-500 text-sm font-medium">Vendas Pendentes</span>
                <span class="text-4xl font-bold text-gray-900 dark:text-white">{{ totalRecords }}</span>
                <div class="flex gap-3 mt-2">
                    <span
                        class="text-xs font-semibold text-danger bg-danger/10 px-2 py-0.5 rounded-full">Assinatura</span>
                    <span
                        class="text-xs font-semibold text-danger bg-danger/10 px-2 py-0.5 rounded-full">Documentação</span>
                </div>
            </div>
            <div class="w-12 h-12 bg-red-50 dark:bg-red-900/20 rounded-lg flex items-center justify-center">
                <i class="pi pi-lock text-danger text-xl"></i>
            </div>
        </div>

        <!-- Card Documentos Verificados -->
        <div
            class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700 flex justify-between items-center">
            <div class="flex flex-col gap-1">
                <span class="text-gray-500 text-sm font-medium">Documentos verificados</span>
                <span class="text-4xl font-bold text-green-600">2</span>
                <div class="mt-2">
                    <span
                        class="text-xs font-semibold text-green-600 bg-green-50 px-2 py-0.5 rounded-full">Aprovados</span>
                </div>
            </div>
            <div class="w-12 h-12 bg-green-50 dark:bg-green-900/20 rounded-lg flex items-center justify-center">
                <i class="pi pi-dollar text-green-600 text-xl"></i>
            </div>
        </div>
    </div>

    <!-- Lista de Pendências -->
    <div
        class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden">
        <div class="p-6 border-b border-gray-100 dark:border-gray-700">
            <h2 class="text-lg font-bold text-gray-900 dark:text-white">Lista de Pendências</h2>
            <div class="relative mt-4">
                <i class="pi pi-search absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"></i>
                <input type="text" pInputText placeholder="Buscar por imóvel, cliente ou corretor..."
                    class="w-full pl-12 pr-4 py-3 bg-gray-50 dark:bg-gray-900 border-none rounded-lg focus:ring-2 focus:ring-primary shadow-none"
                    [(ngModel)]="filtroTexto" (input)="onFilterChange()">
            </div>
        </div>

        <!-- Itens da Lista -->
        <div class="divide-y divide-gray-100 dark:divide-gray-700">
            <div *ngFor="let venda of vendasFiltradas" class="group">
                <!-- Header do Item (Accordion Toggle) -->
                <div (click)="toggleExpand(venda)"
                    class="p-6 flex items-center justify-between cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-900 transition-colors">

                    <div class="flex items-center gap-4">
                        <div class="w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center">
                            <i class="pi pi-home text-primary"></i>
                        </div>
                        <div class="flex flex-col">
                            <span class="font-bold text-gray-900 dark:text-white">{{ venda.unidade }} - {{
                                venda.empreendimento }}</span>
                            <span class="text-sm text-gray-500">{{ venda.endereco }} | {{ venda.nomeCliente }}</span>
                        </div>
                    </div>

                    <div class="flex items-center gap-4">
                        <span
                            [class]="'px-3 py-1 rounded-md text-xs font-bold ' + (venda.statusGeral === 'Pendente' ? 'bg-red-500 text-white' : 'bg-green-500 text-white')">
                            {{ venda.statusGeral | uppercase }}
                        </span>
                        <i class="pi" [ngClass]="venda.expanded ? 'pi-chevron-up' : 'pi-chevron-down'"
                            class="text-gray-400"></i>
                    </div>
                </div>

                <!-- Conteúdo Expandido (Documentos) -->
                <div *ngIf="venda.expanded" class="px-20 pb-6">
                    <div class="pt-4 border-t border-gray-100 dark:border-gray-700">
                        <h4 class="text-sm font-bold text-gray-900 dark:text-white mb-4">Arquivos anexados</h4>
                        <div class="space-y-4">
                            <div *ngFor="let doc of venda.documentos" class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div
                                        class="w-10 h-10 bg-red-50 dark:bg-red-900/20 rounded flex items-center justify-center">
                                        <i class="pi pi-file-pdf text-danger"></i>
                                    </div>
                                    <div class="flex flex-col">
                                        <span class="text-sm font-bold">{{ doc.tipo }}</span>
                                        <span class="text-xs text-gray-500">Documento entregue</span>
                                    </div>
                                </div>
                                <span
                                    [class]="'text-xs font-bold ' + (doc.status === 'Pendente' ? 'text-danger' : 'text-success')">
                                    {{ doc.status }}
                                </span>
                            </div>

                            <!-- Caso não tenha documentos carregados ainda -->
                            <div *ngIf="!venda.documentos || venda.documentos.length === 0"
                                class="text-sm text-gray-500">
                                Nenhum documento encontrado.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Empty State -->
            <div *ngIf="vendasFiltradas.length === 0" class="p-10 text-center text-gray-500">
                Nenhuma pendência encontrada com o filtro atual.
            </div>
        </div>
    </div>
</div>

<p-toast></p-toast>