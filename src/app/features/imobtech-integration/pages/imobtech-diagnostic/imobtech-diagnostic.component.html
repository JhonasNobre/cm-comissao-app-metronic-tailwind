<div class="container mx-auto p-4">
    <p-toast></p-toast>

    <div class="flex justify-between items-center mb-6">
        <h1 class="text-2xl font-bold dark:text-gray-100">Diagnóstico Imobtech (Lab)</h1>
        <p-button label="Limpar Logs" icon="pi pi-trash" (onClick)="limparLogs()"
            styleClass="p-button-outlined p-button-secondary"></p-button>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Cancelamento -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-6">
            <h3 class="font-bold mb-4 dark:text-gray-200">Cancelamento</h3>

            <div class="mb-4">
                <label class="text-sm font-medium text-gray-700 dark:text-gray-300 block mb-1">IDs Remessas
                    (CSV)</label>
                <div class="p-inputgroup">
                    <input pInputText [(ngModel)]="idsRemessa" placeholder="Ex: 123, 456" />
                    <button type="button" pButton icon="pi pi-times" label="Cancelar Remessa" class="p-button-danger"
                        (click)="testarCancelarRemessa()"></button>
                </div>
            </div>

            <div class="mb-4">
                <label class="text-sm font-medium text-gray-700 dark:text-gray-300 block mb-1">IDs Parcelas
                    (CSV)</label>
                <div class="p-inputgroup">
                    <input pInputText [(ngModel)]="idsParcela" placeholder="Ex: 10, 20" />
                    <button type="button" pButton icon="pi pi-times" label="Cancelar Parcela" class="p-button-danger"
                        (click)="testarCancelarParcelas()"></button>
                </div>
            </div>
        </div>

        <!-- Pix & Rateios -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-6">
            <h3 class="font-bold mb-4 dark:text-gray-200">Consultas Rápidas</h3>

            <div class="mb-4">
                <label class="text-sm font-medium text-gray-700 dark:text-gray-300 block mb-1">CPF/CNPJ (Pix)</label>
                <div class="p-inputgroup">
                    <input pInputText [(ngModel)]="cpfPix" placeholder="000.000.000-00" />
                    <button type="button" pButton icon="pi pi-check" label="Validar Pix" class="p-button-success"
                        (click)="testarPix()"></button>
                </div>
            </div>

            <div class="mb-4">
                <label class="text-sm font-medium text-gray-700 dark:text-gray-300 block mb-1">ID Parcela
                    (Rateios)</label>
                <div class="p-inputgroup">
                    <p-inputNumber [(ngModel)]="idParcelaRateio" placeholder="ID Parcela" mode="decimal"
                        [useGrouping]="false" class="w-full"></p-inputNumber>
                    <button type="button" pButton icon="pi pi-search" label="Buscar Rateios"
                        (click)="testarRateios()"></button>
                </div>
            </div>
        </div>

        <!-- Renegociação -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-6 col-span-2">
            <h3 class="font-bold mb-4 dark:text-gray-200">Renegociação</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="flex flex-col">
                    <label class="text-sm font-medium text-gray-700 dark:text-gray-300 block mb-1">ID Parcela
                        Antiga</label>
                    <p-inputNumber [(ngModel)]="renegIdAntiga" mode="decimal" [useGrouping]="false"
                        styleClass="w-full"></p-inputNumber>
                </div>
                <div class="flex flex-col">
                    <label class="text-sm font-medium text-gray-700 dark:text-gray-300 block mb-1">ID Parcela
                        Nova</label>
                    <p-inputNumber [(ngModel)]="renegIdNova" mode="decimal" [useGrouping]="false"
                        styleClass="w-full"></p-inputNumber>
                </div>
                <div class="md:col-span-3">
                    <label class="text-sm font-medium text-gray-700 dark:text-gray-300 block mb-1">JSON Nova
                        Parcela</label>
                    <textarea pInputTextarea [(ngModel)]="renegJson" [rows]="5"
                        style="width: 100%; font-family: monospace;"></textarea>
                    <div class="mt-2">
                        <p-button label="Executar Renegociação" icon="pi pi-refresh" (onClick)="testarRenegociacao()"
                            styleClass="w-full"></p-button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Logs Window -->
    <div
        class="bg-black text-green-400 p-4 rounded-lg font-mono text-xs h-64 overflow-y-auto shadow-inner border border-gray-700">
        <div *ngFor="let log of logs" class="mb-1 border-b border-gray-800 pb-1 break-all">
            {{ log }}
        </div>
        <div *ngIf="logs.length === 0" class="text-gray-500 italic">Nenhum log disponível.</div>
    </div>
</div>