<!-- Container -->
<div class="kt-container-fluid px-5">
    <div class="flex flex-col gap-5 lg:gap-7.5 w-full">
        <!-- Top Header -->
        <div class="flex flex-wrap items-center lg:items-end justify-between gap-5">
            <div class="flex flex-col justify-center gap-2">
                <h1 class="text-xl font-medium leading-none text-mono">Users</h1>
                <div class="flex items-center flex-wrap gap-1.5 font-medium">
                    <span class="text-base text-secondary-foreground">All Users:</span>
                    <span class="text-base text-foreground font-medium">{{ (users$ | async)?.length || 0 }}</span>
                </div>
            </div>
            <div class="flex items-center gap-2.5">
                <a class="kt-btn kt-btn-primary" routerLink="new">
                    <i class="ki-filled ki-plus"></i>
                    Add User
                </a>
            </div>
        </div>

        <!-- Card -->
        <div class="kt-card kt-card-grid min-w-full">
            <div class="kt-card-header flex-wrap gap-2">
                <h3 class="kt-card-title text-sm">
                    All Users
                </h3>
                <div class="flex flex-wrap gap-2 lg:gap-5">
                    <div class="flex">
                        <label class="kt-input">
                            <i class="ki-filled ki-magnifier"></i>
                            <input type="text" (input)="dt.filterGlobal($any($event.target).value, 'contains')"
                                placeholder="Search users" />
                        </label>
                    </div>
                    <div class="flex flex-wrap gap-2.5">
                        <button class="kt-btn kt-btn-outline kt-btn-primary">
                            <i class="ki-filled ki-setting-4"></i>
                            Filters
                        </button>
                    </div>
                </div>
            </div>
            <div class="kt-card-content">
                <div class="kt-scrollable-x-auto">
                    <p-table #dt [value]="(users$ | async) || []" [rows]="10" [rowsPerPageOptions]="[10, 25, 50, 100]"
                        [paginator]="true" [globalFilterFields]="['name', 'email', 'role', 'status']"
                        [tableStyle]="{ 'min-width': '75rem' }" [rowHover]="true" dataKey="id"
                        tableStyleClass="kt-table table-auto kt-table-border w-full" styleClass="w-full"
                        [showCurrentPageReport]="true" paginatorDropdownAppendTo="body"
                        currentPageReportTemplate="Showing {first} to {last} of {totalRecords} users">
                        <ng-template pTemplate="header">
                            <tr>
                                <th class="w-[60px] text-center pl-5">
                                    <input class="kt-checkbox kt-checkbox-sm" type="checkbox" />
                                </th>
                                <th pSortableColumn="name" class="min-w-[300px]">
                                    <span class="kt-table-col">
                                        <span class="kt-table-col-label">User</span>
                                        <span class="kt-table-col-sort"><p-sortIcon field="name"></p-sortIcon></span>
                                    </span>
                                </th>
                                <th pSortableColumn="role" class="min-w-[150px]">
                                    <span class="kt-table-col">
                                        <span class="kt-table-col-label">Role</span>
                                        <span class="kt-table-col-sort"><p-sortIcon field="role"></p-sortIcon></span>
                                    </span>
                                </th>
                                <th pSortableColumn="status" class="min-w-[150px]">
                                    <span class="kt-table-col">
                                        <span class="kt-table-col-label">Status</span>
                                        <span class="kt-table-col-sort"><p-sortIcon field="status"></p-sortIcon></span>
                                    </span>
                                </th>
                                <th pSortableColumn="joinedDate" class="min-w-[150px]">
                                    <span class="kt-table-col">
                                        <span class="kt-table-col-label">Joined Date</span>
                                        <span class="kt-table-col-sort"><p-sortIcon
                                                field="joinedDate"></p-sortIcon></span>
                                    </span>
                                </th>
                                <th class="w-[100px]">
                                    <span class="kt-table-col">
                                        <span class="kt-table-col-label">Actions</span>
                                    </span>
                                </th>
                            </tr>
                        </ng-template>

                        <ng-template pTemplate="body" let-user>
                            <tr>
                                <td class="text-center pl-5">
                                    <input class="kt-checkbox kt-checkbox-sm" type="checkbox" />
                                </td>
                                <td>
                                    <div class="flex items-center gap-2.5">
                                        <div class="kt-avatar size-9 shrink-0">
                                            <img [src]="user.avatar" alt="" class="rounded-full" />
                                        </div>
                                        <div class="flex flex-col">
                                            <a [routerLink]="[user.id]"
                                                class="text-sm font-medium text-mono hover:text-primary mb-px">{{
                                                user.name
                                                }}</a>
                                            <a [routerLink]="[user.id]"
                                                class="text-sm text-secondary-foreground font-normal hover:text-primary">{{
                                                user.email }}</a>
                                        </div>
                                    </div>
                                </td>
                                <td class="text-foreground font-normal">
                                    {{ user.role }}
                                </td>
                                <td>
                                    <span class="custom-badge" [ngClass]="getStatusBadgeClass(user.status)">
                                        <span class="custom-badge-dot"
                                            [ngClass]="getStatusDotClass(user.status)"></span>
                                        {{ user.status }}
                                    </span>
                                </td>
                                <td class="text-foreground font-normal">
                                    {{ user.joinedDate | date:'dd MMM yyyy' }}
                                </td>
                                <td>
                                    <a [routerLink]="[user.id]" class="kt-btn kt-btn-icon kt-btn-sm kt-btn-light">
                                        <i class="ki-filled ki-pencil"></i>
                                    </a>
                                </td>
                            </tr>
                        </ng-template>
                    </p-table>
                </div>
            </div>
        </div>
    </div>
</div>