<div class="card mb-5 mb-xl-8">
    <div class="card-header border-0 pt-5">
        <h3 class="card-title align-items-start flex-column">
            <span class="card-label fw-bold fs-3 mb-1">Lista de Empresas</span>
            <span class="text-muted mt-1 fw-semibold fs-7">Gerenciamento de empresas parceiras</span>
        </h3>
        <div class="card-toolbar">
            <button class="btn btn-sm btn-light-primary" (click)="onAdd()">
                <i class="pi pi-plus"></i> Nova Empresa
            </button>
        </div>
    </div>

    <div class="card-body py-3">
        <ng-container *ngIf="companies$ | async as companies">
            <p-table #dt [value]="companies" [rows]="10" [paginator]="true" [rowsPerPageOptions]="[10, 25, 50, 100]"
                [globalFilterFields]="['name', 'tradeName', 'cnpj', 'email', 'status']" styleClass="p-datatable-generic"
                tableStyleClass="kt-table table-auto kt-table-border w-full" paginatorDropdownAppendTo="body"
                currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} registros"
                [showCurrentPageReport]="true">

                <ng-template pTemplate="caption">
                    <div class="flex align-items-center justify-content-between">
                        <span class="p-input-icon-left">
                            <i class="pi pi-search"></i>
                            <input pInputText type="text"
                                (input)="dt.filterGlobal($any($event.target).value, 'contains')" placeholder="Buscar..."
                                class="p-inputtext-sm" />
                        </span>
                    </div>
                </ng-template>

                <ng-template pTemplate="header">
                    <tr class="fw-bold fs-6 text-gray-800 border-bottom-2 border-gray-200">
                        <th pSortableColumn="name">Razão Social <p-sortIcon field="name"></p-sortIcon></th>
                        <th pSortableColumn="tradeName">Nome Fantasia <p-sortIcon field="tradeName"></p-sortIcon></th>
                        <th pSortableColumn="cnpj">CNPJ <p-sortIcon field="cnpj"></p-sortIcon></th>
                        <th pSortableColumn="status">Status <p-sortIcon field="status"></p-sortIcon></th>
                        <th pSortableColumn="createdAt">Data Cadastro <p-sortIcon field="createdAt"></p-sortIcon></th>
                        <th class="text-end min-w-100px">Ações</th>
                    </tr>
                </ng-template>

                <ng-template pTemplate="body" let-company>
                    <tr>
                        <td>
                            <div class="d-flex flex-column">
                                <a href="#" class="text-dark fw-bold text-hover-primary fs-6">{{ company.name }}</a>
                                <span class="text-muted fw-semibold text-muted d-block fs-7">{{ company.email }}</span>
                            </div>
                        </td>
                        <td>
                            <span class="text-gray-800 fw-bold d-block fs-6">{{ company.tradeName }}</span>
                        </td>
                        <td>
                            <span class="text-gray-600 fw-bold d-block fs-6">{{ company.cnpj }}</span>
                        </td>
                        <td>
                            <span class="badge" [ngClass]="getStatusBadgeClass(company.status)">{{ company.status
                                }}</span>
                        </td>
                        <td>
                            <span class="text-muted fw-semibold text-muted d-block fs-7">{{ company.createdAt |
                                date:'dd/MM/yyyy' }}</span>
                        </td>
                        <td class="text-end">
                            <button pButton pRipple icon="pi pi-pencil"
                                class="p-button-rounded p-button-text p-button-sm me-1"
                                (click)="onEdit(company)"></button>
                            <button pButton pRipple icon="pi pi-trash"
                                class="p-button-rounded p-button-text p-button-danger p-button-sm"
                                (click)="onDelete(company)"></button>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </ng-container>
    </div>
</div>