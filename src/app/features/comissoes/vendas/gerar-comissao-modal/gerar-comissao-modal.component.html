<p-dialog header="Gerar Comissão" [(visible)]="visible" [modal]="true" [style]="{width: '450px'}" [draggable]="false"
    [resizable]="false" (onHide)="close()">

    <div class="flex flex-col gap-4" *ngIf="venda">
        <div class="p-3 bg-gray-50 rounded border border-gray-100">
            <p class="text-sm text-gray-500 mb-1">Venda Selecionada</p>
            <p class="font-medium text-gray-900">{{ venda.nomeCliente || 'Cliente N/A' }}</p>
            <div class="flex justify-between mt-2">
                <span class="text-xs text-gray-500">Código: {{ venda.idVendaLegado }}</span>
                <span class="font-bold text-primary">R$ {{ venda.valorTotalVenda | number:'1.2-2' }}</span>
            </div>
        </div>

        @if (semEstruturaVinculada) {
        <div class="p-3 bg-amber-50 rounded border border-amber-200 flex items-start gap-2">
            <i class="pi pi-exclamation-triangle text-amber-500 mt-0.5 flex-shrink-0"></i>
            <p class="text-sm text-amber-800">
                Esta venda não possui uma estrutura de comissão vinculada. Vincule uma estrutura antes de gerar a comissão.
            </p>
        </div>
        } @else {
        <div class="p-3 bg-green-50 rounded border border-green-100 flex items-center gap-2">
            <i class="pi pi-check-circle text-green-600 flex-shrink-0"></i>
            <p class="text-sm text-green-800">Estrutura de comissão vinculada. Clique em <strong>Gerar Comissão</strong> para confirmar.</p>
        </div>
        }
    </div>

    <ng-template pTemplate="footer">
        <button pButton pRipple label="Cancelar" icon="pi pi-times" class="p-button-text" (click)="close()">
        </button>
        <button pButton pRipple label="Gerar Comissão" icon="pi pi-check" class="p-button-primary" (click)="confirmar()"
            [loading]="saving" [disabled]="semEstruturaVinculada">
        </button>
    </ng-template>
</p-dialog>
