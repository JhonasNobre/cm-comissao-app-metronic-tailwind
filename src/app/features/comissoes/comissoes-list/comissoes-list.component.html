<div class="kt-container-fluid">
    <div class="flex flex-col gap-5 pb-5">

        <!-- Header & Breadcrumbs -->
        <div class="flex items-center justify-between">
            <div>
                <h1 class="text-xl font-bold text-gray-900">Comissões</h1>
                <div class="text-sm text-gray-500">Dashboard / Listagem</div>
            </div>

            <button pButton label="Exportar relatório" icon="pi pi-download" (click)="onExportarRelatorio()"
                class="p-button-primary p-button-sm" [loading]="loading"></button>
        </div>

        <!-- Custom Tabs -->
        <div class="flex border-b border-gray-200">
            <button class="px-4 py-2 font-medium text-sm border-b-2 transition-colors duration-200 focus:outline-none"
                [ngClass]="activeTab === 'historico' ? 'border-primary text-primary' : 'border-transparent text-gray-500 hover:text-gray-700'"
                (click)="setActiveTab('historico')">
                Histórico
            </button>
            <button class="px-4 py-2 font-medium text-sm border-b-2 transition-colors duration-200 focus:outline-none"
                [ngClass]="activeTab === 'pendentes' ? 'border-primary text-primary' : 'border-transparent text-gray-500 hover:text-gray-700'"
                (click)="setActiveTab('pendentes')">
                Comissões Pendentes
            </button>
        </div>

        <!-- Filters (Simplificado) -->
        <div class="card p-4 flex flex-wrap gap-4 items-center">
            <div class="flex-1 min-w-[300px]">
                <span class="p-input-icon-left w-full">
                    <i class="pi pi-search"></i>
                    <input type="text" pInputText placeholder="Buscar por imóvel, cliente ou corretor..."
                        class="w-full p-inputtext-sm" />
                </span>
            </div>
            <!-- Outros filtros dropdowns mocks -->
            <div class="flex gap-2 items-center">
                <button pButton label="Produto: Todos" class="p-button-text p-button-secondary p-button-sm"></button>
                <button pButton label="Cidade: Todas" class="p-button-text p-button-secondary p-button-sm"></button>
                <p-select [options]="statusComissaoOptions" [(ngModel)]="filtrosPendentes.statusComissao"
                    placeholder="Status: Pendente" [showClear]="false" (onChange)="onStatusComissaoChange()"
                    styleClass="w-44"></p-select>
            </div>
        </div>

    </div>
</div>

<div class="kt-container-fluid">
    <div class="card-body pt-0">

        <!-- Tabela Histórico -->
        <app-generic-p-table *ngIf="activeTab === 'historico'" [tableData]="historico"
            [columnDefinition]="columnsHistorico" [totalRecords]="totalRecordsHistorico" [serverSidePagination]="true"
            [rows]="10" [displayCreateAction]="false" [displayDetailAction]="true"
            (lazyLoad)="onLazyLoadHistorico($event)" (detail)="onDetail($event)">
        </app-generic-p-table>

        <!-- Tabela Pendentes -->
        <app-generic-p-table *ngIf="activeTab === 'pendentes'" [tableData]="pendentes"
            [columnDefinition]="columnsPendentes" [totalRecords]="totalRecordsPendentes" [serverSidePagination]="true"
            [rows]="10" [displayCreateAction]="false" [displayDetailAction]="true"
            (lazyLoad)="onLazyLoadPendentes($event)" (detail)="onDetail($event)">
        </app-generic-p-table>

    </div>
</div>

<!-- Menu de Ações -->
<p-menu #menu [popup]="true" [model]="menuItems"></p-menu>

<p-confirmDialog [style]="{width: '450px'}" rejectButtonStyleClass="p-button-text"></p-confirmDialog>
<p-toast></p-toast>